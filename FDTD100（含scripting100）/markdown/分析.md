## 1. 数据类型

![](index_files/4e9949a7-7612-4199-a657-88530e7c06e7.jpg)

![](index_files/e27727c4-0b45-4f12-8673-3adbb9f4a15c.jpg)

## 2. 数据集（datasets）

#### 2.1 结构

数据集是最常用的数据返回方式。其构成如下：

![](index_files/35dc4395-ed8c-4ecd-a432-f99ef88d849d.jpg)

#### 2.2 数据集举例

![](index_files/1a3a80a6-df9a-4f7b-b541-31021c28018f.jpg)

![](index_files/8db45a3a-5540-4e42-b4df-cdcb09fb92ff.jpg)

## 3. 访问数据集

模型运行之后，处于分析状态时，所有包含有可访问数据集的节点都被标注以一个红色的数据集符号：

![](index_files/6399443c-3d4a-40b2-bd1f-14126adf0d15.png)

从前面的学习中，我们已经会了如何从各节点中通过 visualize 方式查看计算结果，此处不具。这里介绍如何将数据集发送到 script 工作区并进行后处理的。

#### 3.1 script 工作区

FDTD 工作区所涉及的所有子窗口都可以通过 view - windows 打开和关闭。

![](index_files/25c654a9-0ec9-4cc0-94d4-5c037f08a55e.png)

下图即是 FDTD 的 script 工作区：

![](index_files/2157c899-4bda-4509-84c0-f83808c20dcc.png)

跟MATLAB的布局是很类似的。右键数据集，并选择 send to script 即可把该数据导入 script 的工作区：

![](index_files/e5a6af5c-8a89-46c9-8eb3-82bfd8ee45e4.png)

加载不同模型的时候，工作区的变量不会被清楚，其将一直存在于工作区，知道用户手动删除（方法同MATLAB），或则关闭 FDTD 软件。工作区的数据也不会被保存到文件中，所以如需保存工作区的运算结果，则需要人为地导出数据：

![](index_files/c65bcd6f-b7e4-4062-8af5-910e7581082b.jpg)

在 script favorites 窗口中可以保存自己常用的命令，右键添加新命令即可：

![](index_files/441a0a4f-7778-4850-a389-d0b2d0d77526.png)

## 4. 组

#### 4.1 分析组

分析组可以包含结构、光源、monitor等子类，其作用是基于其包括的子类的计算结果进行后处理，以得到用户想要得到的运算结果。下图即是一个分析组：

![](index_files/e7867cba-8854-4656-84ad-aa65e0068ad9.jpg)

其作用是对Box六个面的能量输入输出进行检测，加和之后得到整个Box能量输入输出情况。对象树最顶上的 `model` 即是一个分析组：

![](index_files/ea4aaff7-a94e-453f-a0d6-db751f00b404.png)

分析组中包含多个子类，如上图。可以在分析组的 setup 脚本中对这些子类的属性进行设置。并在 Analysis 脚本中对这些子类的运算结果进行分析，并输出用户想要的结果。

在 group 中添加空的分析组：

![](index_files/ceef9a06-73a8-47e7-815f-606de9a0feaa.png)

- setup 选项

可以在设置中新建属性并对其进行设置。这些自定义属性可以在 script 中进行使用。

![](index_files/88504880-4142-448d-90fd-9b482ffa3e7a.jpg)

script 选项中可以对分析组中的对象及其属性进行删改。

- Analysis 选项

在变量栏中，可以设置运算中所需要涉及到的变量，其下方可以设置输出结果的变量名。

在脚本栏中，可以对分析组子类的运行结果进行后处理，以得到目标结果。

#### 4.2 其他组

除了分析组之外，还有 container 组和 structure 组。container 组可以包含任何类，但不能对类的属性进行设置，也不能收集数据。structure 类只能包含结构类。

![](index_files/efb185cc-963c-4378-a908-f3bc6ab91955.jpg)

#### 4.3 预置组

FDTD 内部有很多预设的组供我们选用，比如之前用到的光子晶体 structure group。此处以光功率分析组为例进行说明：

![](index_files/47219432-9075-49bf-9ab4-334ec183a0d7.png)

可以通过本例学习分析组相关的设置。按我的理解，分析组本质就是一个函数而已。或者更复杂一点，其本质是一个类，调用各子类的属性进行更高层次的计算并输出结果。

## 5. 数据导出

数据导出分为在图形窗口中导出（一眼就会）以及通过脚本导出。通过脚本导出只涉及两三个命令，可以去查官方文档，不具。

## 6. 其他

#### 6.1 收敛性分析

误差主要来自网格密度、PML层设置以及材料拟合等。

![](index_files/f1a37e6b-69f9-48a0-9d15-bc53e1b2be51.jpg)

收敛性分析可以通过增加网格密度等扫描参数的方法进行，同时输出某一个运行结果的值，已查看其是否趋于稳定：

![](index_files/66eabb21-b81c-498a-8a60-3a6f8591bfcf.jpg)

#### 6.2 仿真时间

由于频域结果是通过时域信号进行傅里叶变换得到的，因此，当时域信号未完全收敛到0即结束仿真时，通常会引起频域信号的误差。通常可以设置一个较长的仿真时间，并勾选提前结束选项：

![](index_files/11dd7f8e-a656-4ce9-80c0-840d01b76204.png)

可以通过以下几个方法查看仿真是否提前结束运行：

![](index_files/b138fcf5-db69-4fea-a2c4-49e9af400080.jpg)




